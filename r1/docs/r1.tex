\documentclass[11pt,a4paper]{jsarticle}
\usepackage{ascmac}
%
% ######## measure #########
% # mm = 1mm = 2.85pt      #
% # cm = 10mm = 28.5pt     #
% # in = 25.4mm = 72.27pt  #
% # pt = 0.35mm = 1pt      #
% # em = width of [M]      #
% # ex = height of [x]     #
% # zw = width of [Kanji]  #
% # zh = height of [Kanji] #
% ##########################
% ##################### Portrait Setting #########################
% # TOP = 1inch + \voffset + \topmargin + \headheight + \headsep #
% #     = 1inch + 0pt + 4pt + 20pt + 18pt (default)              #
% # BOTTOM = \paperheight - TOP -\textheight                     #
% ################################################################
\setlength{\textheight}{\paperheight}   % 紙面縦幅を本文領域にする（BOTTOM=-TOP）
\setlength{\topmargin}{-5.4truemm}       % 上の余白を30mm（=1inch+4.6mm）に
\addtolength{\topmargin}{-\headheight}  % 
\addtolength{\topmargin}{-\headsep}     % ヘッダの分だけ本文領域を移動させる
\addtolength{\textheight}{-50truemm}    % 下の余白も30mm（BOTTOM=-TOPだから+TOP+30mm）
% #################### Landscape Setting #######################
% # LEFT = 1inch + \hoffset + \oddsidemargin (\evensidemargin) #
% #      = 1inch + 0pt + 0pt                                   #
% # RIGHT = \paperwidth - LEFT - \textwidth                    #
% ##############################################################
\setlength{\textwidth}{\paperwidth}     % 紙面横幅を本文領域にする（RIGHT=-LEFT）
\setlength{\oddsidemargin}{-0.4truemm}  % 左の余白を25mm(=1inch-0.4mm)に
\setlength{\evensidemargin}{-0.4truemm} % 
\addtolength{\textwidth}{-50truemm}     % 右の余白も25mm（RIGHT=-LEFT）
%
%
\begin{document}

\title{数値解析演習第1回レポート}
\author{14-13394 増田卓斗}
\date{}
\maketitle

\section{}
float型を用いた結果は以下のようになった。
\begin{table}[htb]
  \begin{tabular}{|c||r|r|r|} \hline
    $n \backslash x$ & 1 & 0.1 & 0.15625 \\ \hline \hline
    $10^2$ & 100.000000 & 10.000002 & 15.625000 \\ \hline
    $10^5$ & 100000.000000 & 9998.556641 & 15625.000000 \\ \hline
    $10^8$ & 16777216.000000 & 2097152.000000 & 4194304.000000 \\ \hline
  \end{tabular}
\end{table}

考察:$x=1$と$x=0.15625$は$10^2,10^5$が正確に計算されているが、$10^8$は正確に計算できていない。これは大きな数と小さな数を足すために浮動小数点数の指数部を合わせる時に小さな数の情報が落ちてしまい足し算が正確に行われていないためであると考えられる。
$x=0.1$については$10^2,10^5$の時は少し数値にズレがあり、$10^8$は正確に計算できていない。$10^8$については上の理由と同様で、$10^2,10^5$の時のズレは、0.1を２進数で表すと循環小数になり、実数型ではそれを途中で打ち切って計算しているためだと考えられる。\\


またdouble型を用いた結果は以下のようになった。
\begin{table}[htb]
  \begin{tabular}{|c||r|r|r|} \hline
    $n \backslash x$ & 1 & 0.1 & 0.15625 \\ \hline \hline
    $10^2$ & 100.000000 & 10.000002 & 15.625000 \\ \hline
    $10^5$ & 100000.000000 & 10000.000000 & 15625.000000 \\ \hline
    $10^8$ & 100000000.000000 & 9999999.981129 & 15625000.000000 \\ \hline
  \end{tabular}
\end{table}

\section{}
\noindent
float型を用いた結果は以下のようになった。\\
n=1: 1.000000 \\
n=2: 0.999999 \\
n=3: 0.999991 \\
n=4: 1.000054 \\
n=5: 1.000990 \\
n=6: 1.009039 \\
n=7: 1.064767 \\
n=8: 0.250000 \\
n=9: 0.031250 \\
考察:$n=7$までの値のズレについては、2進数で表すと循環小数になることが原因で、$n=8,9$については大きな数と小さな数を足したことが原因だと考えられる。
また計算結果の精度は$n=6$まで、実行時間は$n=9$まで耐えられると思った。

\section{}
$2^n$をint型を用いて$n$を1から256まで動かした結果、$n=30$までは正確に計算できたが、$n=31$以降は-2147483648となった。これはint型の最大値が$2^31-1$なので、$n=31$以降はオーバーフローして-2147483648となっている。

$2^{-n}$はfloat型を用いて$n$を1から256まで動かした結果、$n=149$までは値が計算されているように見えたが、$n=150$以降は0.000000となった。ここで、$2^{-149}$は$1.401298 \times 10^{-45}$であった。これは$n=149$まではfloat型で表すことのできる数で、$n=150$以降はアンダーフローして0.000000となっていると考えられる。

\section*{アンケート}
\noindent
1.家 \\
2.\ MacOS X \\
3.言語:C,環境:gcc \\
4.普通だった。量もちょうどいいくらいだった。

\newpage
\section*{ソースコード}
問題1のfloat型を用いたもの。double型にするにはfloatをすべてdoubleに書き換えればよい。
\begin{screen}
\begin{verbatim}
#include <stdio.h>
#include <math.h>
//問題１
int calc(float x0, int ind) {
    float x=0;
    int i;
    for (i=0; i<pow(10,ind); i++) {
        x += x0;
    }
    printf("n=10^%d: %f\n",ind , x);
    return 0;
}

int main() {
    float x1 = 1;
    float x2 = 0.1;
    float x3 = 0.15625;
    
    printf("x=1:\n");
    calc(x1,2);
    calc(x1,5);
    calc(x1,8);
    printf("\nx=0.1:\n");
    calc(x2,2);
    calc(x2,5);
    calc(x2,8);
    printf("\nx=0.15625:\n");
    calc(x3,2);
    calc(x3,5);
    calc(x3,8);
    
    return 0;
}
\end{verbatim}
\end{screen}

\begin{itembox}[c]{問題2のソースコード}
\begin{verbatim}
#include <stdio.h>
#include <math.h>
//問題２
int calc(int n) {
    float x = 0;
    float x0 = powf(10,-n);
    int i;
    for (i=0; i<pow(10,n); i++) {
        x += x0;
    }
    printf("n=%d: %f\n", n, x);
    return 0;
}

int main() {
    int j;
    for (j=1; j<10; j++){
        calc(j);
    }
    
    return 0;
}
\end{verbatim}
\end{itembox}

\begin{itembox}[c]{問題3のソースコード}
\begin{verbatim}
#include <stdio.h>
#include <math.h>
//問題３
int calc1(int n) {
    int x;
    x = powf(2, n);
    
    printf("n=%d: %d\n", n, x);
    return 0;
}

int calc2(int n) {
    float y;
    y = powf(2, -n);
    
    printf("n=%d: %e\n", n, y);
    return 0;
}

int main() {
    int j;
    
    for (j=1; j<=256; j++){
        calc1(j);
    }
    printf("\n");
    
    for (j=1; j<=256; j++){
        calc2(j);
    }
    
    return 0;
}
\end{verbatim}
\end{itembox}

\end{document}